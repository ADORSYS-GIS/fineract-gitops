apiVersion: v1
kind: ConfigMap
metadata:
  name: cashier-app-scripts
  labels:
    app: cashier-app
data:
  rewrite-html.sh: |
    #!/bin/sh
    
    # Copy original app files
    cp -r /original-app/usr/share/nginx/html/* /usr/share/nginx/html/ 2>/dev/null || true
    
    # Rewrite HTML file
    sed -i 's|href="/dist/|href="/cashier/dist/|g' /usr/share/nginx/html/index.html
    sed -i 's|href="/assets/|href="/cashier/assets/|g' /usr/share/nginx/html/index.html
    sed -i 's|src="/assets/|src="/cashier/assets/|g' /usr/share/nginx/html/index.html
    
    # Start nginx
    exec nginx -g 'daemon off;'
