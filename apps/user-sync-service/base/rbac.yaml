---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: fineract-keycloak-sync-role
  labels:
    app: fineract-keycloak-sync
spec:
  rules:
  # Allow reading secrets for Keycloak credentials
  - apiGroups: [""]
    resources: ["secrets"]
    resourceNames:
      - keycloak-admin-credentials
      - keycloak-client-secrets
    verbs: ["get", "list"]

  # Allow reading configmaps for configuration
  - apiGroups: [""]
    resources: ["configmaps"]
    resourceNames:
      - user-sync-config
    verbs: ["get", "list"]

---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: fineract-keycloak-sync-binding
  labels:
    app: fineract-keycloak-sync
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: fineract-keycloak-sync-role
subjects:
- kind: ServiceAccount
  name: fineract-keycloak-sync
