apiVersion: fineract.apache.org/v1
kind: FinancialReport
metadata:
  name: active-clients-summary
  labels:
    report-category: financial
spec:
  reportName: Active Clients Summary
  reportType: Balance Sheet
  useReport: true
  reportSql: "SELECT\n    c.display_name as client_name,\n    c.account_no as client_account,\n\
    \    o.name as office_name,\n    COUNT(DISTINCT l.id) as total_loans,\n    SUM(l.principal_outstanding_derived)\
    \ as loan_balance,\n    COUNT(DISTINCT s.id) as total_savings,\n    SUM(s.account_balance_derived)\
    \ as savings_balance\nFROM m_client c\nLEFT JOIN m_loan l ON c.id = l.client_id\
    \ AND l.loan_status_id = 300\nLEFT JOIN m_savings_account s ON c.id = s.client_id\
    \ AND s.status_enum = 300\nJOIN m_office o ON c.office_id = o.id\nWHERE c.status_enum\
    \ = 300\nGROUP BY c.id, c.display_name, c.account_no, o.name\nORDER BY loan_balance\
    \ DESC"
